import sys

table = {'': 0, 'G': 57, 'A': 71, 'S': 87, 'P': 97, 'V': 99, 'T': 101, 'C': 103, 'L': 113, 'N': 114, 'D': 115, 'K': 128,
         'E': 129, 'M': 131, 'H': 137, 'F': 147, 'R': 156, 'Y': 163, 'W': 186}


def mass(s):
    m = 0
    for i in s:
        m = m + table[i]
    return m


def spectr(s):
    out = []
    out.append(0)
    k = len(s)
    for i in range(1, k):
        for j in range(k):
            if j + i <= k:
                out.append(mass(s[j:j + i]))
            else:
                out.append(mass(s[j:k] + s[0:j + i - k]))
    out.append(mass(s))
    out.sort()
    return out


def score(s1, s2):
    count = 0
    k1 = len(s1)
    k2 = len(s2)
    for i in range(k1):
        for j in range(k2):
            if s1[i] == s2[j] and s1[i] != -1 and s2[j] != -1:
                count = count + 1
                s1[i] = -1
                s2[j] = -1
    return count - 1


rtable = {}

for i in table.keys():
    rtable[table[i]] = i

s = '0 71 71 97 97 99 113 113 113 113 128 128 128 128 128 129 129 129 131 142 156 163 163 199 199 210 210 226 227 230 242 242 253 256 257 257 259 270 270 276 276 284 291 292 298 323 323 328 339 354 355 358 358 369 381 382 385 387 389 398 399 404 405 405 420 429 436 447 452 452 482 486 486 486 491 497 500 510 510 516 517 518 527 533 534 544 557 560 562 565 565 599 604 613 614 614 615 615 626 628 628 638 638 647 657 662 673 673 675 678 685 690 712 727 728 728 733 743 744 756 756 757 766 769 770 770 775 786 789 801 803 804 814 840 841 841 846 856 857 867 868 872 883 884 885 885 897 899 902 911 914 917 920 929 932 943 969 970 980 982 985 996 996 996 1004 1012 1013 1013 1014 1027 1031 1033 1042 1045 1048 1056 1060 1067 1098 1109 1109 1110 1124 1124 1125 1127 1132 1133 1138 1142 1142 1144 1155 1159 1161 1162 1169 1173 1176 1195 1222 1237 1238 1239 1240 1241 1252 1255 1261 1261 1266 1266 1272 1275 1286 1287 1288 1289 1290 1305 1332 1351 1354 1358 1365 1366 1368 1372 1383 1385 1385 1389 1394 1395 1400 1402 1403 1403 1417 1418 1418 1429 1460 1467 1471 1479 1482 1485 1494 1496 1500 1513 1514 1514 1515 1523 1531 1531 1531 1542 1545 1547 1557 1558 1584 1595 1598 1607 1610 1613 1616 1625 1628 1630 1642 1642 1643 1644 1655 1659 1660 1670 1671 1681 1686 1686 1687 1713 1723 1724 1726 1738 1741 1752 1757 1757 1758 1761 1770 1771 1771 1783 1784 1794 1799 1799 1800 1815 1837 1842 1849 1852 1854 1854 1865 1870 1880 1889 1889 1899 1899 1901 1912 1912 1913 1913 1914 1923 1928 1962 1962 1965 1967 1970 1983 1993 1994 2000 2009 2010 2011 2017 2017 2027 2030 2036 2041 2041 2041 2045 2075 2075 2080 2091 2098 2107 2122 2122 2123 2128 2129 2138 2140 2142 2145 2146 2158 2169 2169 2172 2173 2188 2199 2204 2204 2229 2235 2236 2243 2251 2251 2257 2257 2268 2270 2270 2271 2274 2285 2285 2297 2300 2301 2301 2317 2317 2328 2328 2364 2364 2371 2385 2396 2398 2398 2398 2399 2399 2399 2399 2399 2414 2414 2414 2414 2428 2430 2430 2456 2456 2527'
n = 465

sl = s.split(' ')
for i in range(len(sl)):
    sl[i] = int(sl[i])
sl.sort()

s = ''
for i in sl:
    s = s + str(i) + ' '

abc = []

for i in sl:
    if int(i) in rtable:
        abc.append(rtable[int(i)])
print len(abc),
abc = set(abc)
tbl = [i for i in abc]
print len(tbl)

out = []
leader = [0]
while (len(abc)):
    tmp = []
    for i in abc:
        for j in tbl:
            tmp.append(i + j)
    parrent_mass = sl[len(sl) - 1]
    abc = []
    top = {}
    for i in tmp:
        sc = score(spectr(i), sl)
        if mass(i) == parrent_mass:
            if sc > score(leader, sl):
                leader = spectr(i)
        if mass(i) <= parrent_mass:
            top[i] = sc
    tout = list(top.items())
    tout.sort(key=lambda item: item[1])
    tout = tout[::-1]
    count = 0
    for i in tout:
        abc.append(i[0])
        count = count + 1
        if not count < n:
            break
    print len(abc)

for i in leader:
    if i in rtable:
        sys.stdout.write(rtable[i])